---
title:  "Excel数据检查的逻辑"
categories: pipeline
sequence: 002
---

## 点和线联合检查

### 埋深和高程检查

#### 简单介绍

核心检查逻辑：

```text
地面高程 = 埋深 + 管线高程
```

其中，

- 地面高程，位于“点表”当中
- 埋深、管线高程，位于“线表”当中。一条管段，它有“起点”和“终点”：起点埋深、终点埋深、起点高程、终点高程。

---

#### 准备工作

在进行检查之前，先做一些**前期准备工作**：

- 第一步，保证点表（Point）当中的数据正确
  - 第一点，点表当中，不能有重复的点号
  - 第二点，点表当中，“地面高程”应该是数值
- 第二步，保证线表（Line）当中的数据正确
  - 第一点，“起点”和“终点”在点表当中是存在的
  - 第二点，起点埋深、终点埋深、起点高程、终点高程这四个字段，应该都是数值类型。

---

#### 进行验证

前期准备完成之后，进行核心逻辑验证：

```text
地面高程 = 埋深 + 管线高程
```

